// –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ legacy-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã
// –ó–∞–ø—É—Å–∫: node scripts/import-legacy-users.js

// SECURITY: Load from environment variables
const SUPABASE_URL = process.env.SUPABASE_URL || 'https://syxjkircmiwpnpagznay.supabase.co';
const SUPABASE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY;

if (!SUPABASE_KEY) {
  console.error('ERROR: SUPABASE_SERVICE_ROLE_KEY environment variable is required');
  process.exit(1);
}

// –î–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets
const csvData = `tg_id,username,expires_date,days_remaining,payment_method,days_to_add,note
8300761138,@georgefatov,22.01.2026,24,TOOLSY,24,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1994331495,@cleona3,22.03.2026,83,TOOLSY,83,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1856301521,@ildGR,18.01.2026,20,TOOLSY,20,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
388159246,@DrIgorStrizheus,18.01.2026,20,TOOLSY,20,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
402132728,@nadusha_25,09.01.2026,11,TOOLSY,11,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
867449600,@Roman4z,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
545378018,@Alex_sologu,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1655224078,@Nikomilloner,16.01.2026,18,TOOLSY,18,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
476812788,@Kirill_Orlov1,16.01.2026,18,TOOLSY,18,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
366791205,@skiff93,28.03.2026,89,TOOLSY,89,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1205038618,@feruz4009,16.01.2026,18,TOOLSY,18,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
6350887190,@pp_andreevich,11.04.2026,103,TOOLSY,103,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5187239164,@SMXRTXSLXV,25.02.2026,58,TOOLSY,58,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
471308774,@aladimgtr,15.01.2026,17,TOOLSY,17,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1868279639,@M_a_r_g_o2,15.01.2026,17,TOOLSY,17,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
148095747,@Armich_life,15.03.2026,76,TOOLSY,76,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
349989149,@yanina_million,15.01.2026,17,TOOLSY,17,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
171638187,@YasmanPavel,15.03.2026,76,TOOLSY,76,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
7173652729,@SergD7777,09.01.2026,11,TOOLSY,11,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5988236830,@silverc212,13.01.2026,15,TOOLSY,15,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1233329038,@vicag1505,12.03.2026,73,TOOLSY,73,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
782197335,@Maestro_grey,06.01.2026,8,TOOLSY,8,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
864891681,@levongasparyan,06.01.2026,8,TOOLSY,8,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1369636549,@AlegraA11,12.01.2026,14,TOOLSY,14,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1450738364,@Viktormerkulov,06.01.2026,8,TOOLSY,8,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
257140703,@VitaliyEvd,27.02.2026,60,TOOLSY,60,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1035578226,@BAKHTIIAR77,16.04.2026,108,TOOLSY,108,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
516840964,@Irina_kiyanitsa,05.01.2026,7,TOOLSY,7,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
351049366,–Ω–µ—Ç,06.01.2026,8,TOOLSY,8,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
970510414,@pocc44,04.01.2026,6,TOOLSY,6,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
748138210,@podcherednikov,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
367569800,@rtyui44566,05.01.2026,7,TOOLSY,7,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
7240799742,@oleg_cryptop,20.02.2026,53,TOOLSY,53,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
311614211,@vlaad788,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
653993942,@MihailFilatov1971,09.01.2026,11,TOOLSY,11,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
75960072,@EvgeniiSayhello,05.01.2026,7,TOOLSY,7,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1227255433,@Alexch0405,04.01.2026,6,TOOLSY,6,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
509770378,@Doomsday911,07.01.2026,9,TOOLSY,9,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
718629958,@Serhii_Ked,17.02.2026,50,TOOLSY,50,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
805827733,@Badei13,12.02.2026,45,TOOLSY,45,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
495767133,@tusla,25.03.2026,86,TOOLSY,86,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
513002940,@Andrey_malyarka,25.03.2026,86,TOOLSY,86,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
795063723,@dimbor1411,04.01.2026,6,TOOLSY,6,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
829788244,–Ω–µ—Ç,10.03.2026,71,TOOLSY,71,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
697728937,@Bagibooms,17.02.2026,50,TOOLSY,50,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1482476638,@SnakeGon,22.04.2026,114,TOOLSY,114,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
652311955,@Elena586,11.01.2026,13,TOOLSY,13,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
211884013,@s4acher,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
749706574,@Max_3y61k,06.01.2026,8,TOOLSY,8,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
265716648,@ErnarDan,09.02.2026,42,TOOLSY,42,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
204200334,@bogachds,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
956268196,@Ak1m_XL,19.01.2026,21,TOOLSY,21,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
111817504,@dpronkin,15.01.2026,17,TOOLSY,17,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1067008592,@roman_1802,04.01.2026,6,TOOLSY,6,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
119535544,@demon191177,03.01.2026,5,TOOLSY,5,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
125467517,@mirou042,11.01.2026,13,TOOLSY,13,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
355360537,@Filip76,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
524107584,@guevara4rever,27.01.2026,29,TOOLSY,29,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1370263839,@axuelll,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
442289695,@ingel_7,18.02.2026,51,TOOLSY,51,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
870492629,@Daniel_Silnichenko,10.03.2026,71,TOOLSY,71,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
492941809,@Maks_GTS,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5250146150,–Ω–µ—Ç,10.03.2026,71,TOOLSY,71,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
385504111,@sergej1000,27.04.2026,119,TOOLSY,119,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
905485471,@Ruslan13051981,23.03.2026,84,TOOLSY,84,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
180741504,@nikpump85,27.01.2026,29,TOOLSY,29,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
626056899,@vd224466,04.01.2026,6,TOOLSY,6,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1856558829,@Nikita1vanov,07.01.2026,9,TOOLSY,9,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
537916108,@spanchiii25,03.02.2026,36,TOOLSY,36,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
482417799,@MiklB,09.01.2026,11,TOOLSY,11,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
439813497,@sfkli,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1771612817,@DjDim4,03.04.2026,95,TOOLSY,95,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
330594093,@XEMius,09.01.2026,11,TOOLSY,11,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1858667077,@inspirer55,01.03.2026,62,TOOLSY,62,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
377842573,@zaytsev_marketer,01.01.2026,3,TOOLSY,3,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5880198635,@vik_antonovi4,31.12.2025,2,TOOLSY,2,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
941968101,@without_knee,07.01.2026,9,TOOLSY,9,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
2146757914,@maxsantas,09.01.2026,11,TOOLSY,11,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1048190983,@ToshkaM,27.04.2026,119,TOOLSY,119,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
275968542,@sergey2x,14.01.2026,16,TOOLSY,16,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
866063584,@Drovosek_13,29.01.2026,31,TOOLSY,31,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
737400359,@dima_lub,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
561384800,@Romka0770,27.05.2026,149,TOOLSY,149,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
352668551,@grits_tatyana,27.01.2026,29,TOOLSY,29,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
7630537552,@Emaaaaa1,01.01.2026,3,TOOLSY,3,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
7022024013,@trymylife,15.01.2026,17,TOOLSY,17,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1192898703,@Zg_JR,08.01.2026,10,TOOLSY,10,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
475070122,@AVETART,13.01.2026,15,TOOLSY,15,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
400564609,@DimaS32,04.03.2026,65,TOOLSY,65,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
150100474,@S_T_P13,01.03.2026,62,TOOLSY,62,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
477154468,@bidonn,16.01.2026,18,TOOLSY,18,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
428627124,@Ivan_Ginko,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
803052608,@KiganJack,01.03.2026,62,TOOLSY,62,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5773787522,@Vova_Ch77,15.01.2026,17,TOOLSY,17,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5736558354,@audit_mironova,24.02.2026,57,TOOLSY,57,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5156873674,@zkizyka11,24.02.2026,57,TOOLSY,57,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1676508728,@Petttrov2015,23.02.2026,56,TOOLSY,56,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1254686972,@IDI_Lean,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
275909622,@payment_successful,22.02.2026,55,TOOLSY,55,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
808551979,@Ramona_more,19.02.2026,52,TOOLSY,52,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
193501883,@Gregory_Kravtsov,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
589971944,@krisavonavi,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
476800214,@Pandaan16,19.01.2026,21,TOOLSY,21,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5023994020,@OlegBezrodnykh,21.01.2026,23,TOOLSY,23,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
456819441,@bontva,19.02.2026,52,TOOLSY,52,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5221582825,@dimabelkov86,20.01.2026,22,TOOLSY,22,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
719033666,@valdis1919,12.02.2026,45,TOOLSY,45,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
472427713,@Sobol_Ol,11.02.2026,44,TOOLSY,44,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
706535202,@natalciukdenis,15.02.2026,48,TOOLSY,48,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
413383543,@vanyatym,09.02.2026,42,TOOLSY,42,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
7896092545,@Mit777mit777,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
210648268,@IlyaMatiborskiy,07.01.2026,9,TOOLSY,9,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
49603778,@A1E2E4,04.02.2026,37,TOOLSY,37,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
425434029,–Ω–µ—Ç,29.01.2026,31,TOOLSY,31,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1451499124,@nataliaz76,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
410182624,@Moovik1,28.01.2026,30,TOOLSY,30,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
477658571,@kavabangazzz,27.01.2026,29,TOOLSY,29,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5716678460,@umnic,25.02.2026,58,TOOLSY,58,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
6762106647,@TotsamuyDmitry,19.01.2026,21,TOOLSY,21,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
911115307,@avpurisev,16.01.2026,18,TOOLSY,18,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
483436404,@T333111,12.01.2026,14,TOOLSY,14,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1798315648,@Andrey77Posokhov,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1923290809,@Ilya_Govoruhin,12.01.2026,14,TOOLSY,14,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1386881817,@IrinaHorizon,18.01.2026,20,TOOLSY,20,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
823051849,–Ω–µ—Ç,07.02.2026,40,TOOLSY,40,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
630592580,@AlexNikolaenko,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5221743053,@SergeyBoroda880,15.02.2026,48,TOOLSY,48,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
238034682,@VLEE888,05.01.2026,7,TOOLSY,7,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1499168857,@papabrazzers,13.01.2026,15,TOOLSY,15,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
156275624,@Smirnovms85,05.04.2026,97,TOOLSY,97,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
7599211566,@docavva,07.01.2026,9,TOOLSY,9,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
6404414652,–Ω–µ—Ç,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1278057938,@andriibendiuk,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
244331143,@PlatonovOleg,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
517855426,@quine2,11.05.2026,133,TOOLSY,133,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
175918781,@artyarik,19.04.2026,111,TOOLSY,111,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
891763981,@AlexKuleshov2023,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1329546723,@alegis_k,31.12.2025,2,TOOLSY,2,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
691390116,@Trainer_Karabelnikov,17.03.2026,78,TOOLSY,78,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
729544930,@millions_profit100,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1624963028,@virtus_kas,17.01.2026,19,TOOLSY,19,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
143761058,@ujin_sdk,12.01.2026,14,TOOLSY,14,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
939275379,@Romzas88,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
184011208,@markrpk,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
819207988,@S_Andrii,08.03.2026,69,TOOLSY,69,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1157126233,@georgiyval,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
276550161,@naksia,06.03.2026,67,TOOLSY,67,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
575753293,@markingoleg,15.03.2026,76,TOOLSY,76,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5064605611,@BKhazanzun,24.01.2026,26,TOOLSY,26,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1308330079,@IgorCh2172,07.02.2026,40,TOOLSY,40,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
738687096,@Aleksej_Pinsk,30.12.2025,1,TOOLSY,1,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
826261514,@oleg_4912,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
407083305,@Natalie_Invest,11.01.2026,13,TOOLSY,13,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
5040534633,@KsenijaM,14.01.2026,16,TOOLSY,16,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
678597120,@Maksonskyi,06.05.2026,128,TOOLSY,128,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
372013387,@kraken_yu,13.01.2026,15,TOOLSY,15,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
511227811,@Roman_Hraichenko,10.01.2026,12,TOOLSY,12,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
1819091592,@PavelB0gdaN,17.04.2026,109,TOOLSY,109,–Ω–µ—Ç –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ`;

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –î–û–ë–ê–í–ò–¢–¨ –¥–Ω–∏ (—É–∂–µ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ)
const usersToAddDays = [
  { tg_id: 2144592855, days: 70 },   // @OleksiiPavlenko777
  { tg_id: 1550982079, days: 167 },  // @Ivan201618
  { tg_id: 1671739127, days: 14 },   // @IrynaK29
  { tg_id: 6957193527, days: 86 },   // @FreestyleFrisbee
  { tg_id: 7601933146, days: 76 },   // @VVII666
  { tg_id: 815830735, days: 43 },    // @Valery_72S
  { tg_id: 1946073683, days: 9 },    // @artemdux1
  { tg_id: 149390130, days: 29 },    // @imaximov89
  { tg_id: 5366052419, days: 12 },   // @Yura_moro
  { tg_id: 7440574509, days: 7 },    // @Smart_Move02
  { tg_id: 943786278, days: 52 },    // @OleksiiMol
  { tg_id: 153689186, days: 7 },     // @slon_j
  { tg_id: 5039684879, days: 14 },   // @Qwerty_286
  { tg_id: 1809448091, days: 10 },   // @plmnko77ASD
  { tg_id: 1812358410, days: 9 },    // @SuperKa0
  { tg_id: 359743018, days: 16 },    // @Svitlana_sold
  { tg_id: 97530953, days: 17 },     // @Ruslan_1276
  { tg_id: 991884752, days: 20 },    // @AIeks_pro
];

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–ª—è –∫–∏–∫–∞
const usersToKick = [
  6675346585,  // –Ω–µ—Ç username
  6989030880,  // @Cindyj3m9mok
];

// –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã DD.MM.YYYY –≤ ISO
function parseDate(dateStr) {
  if (!dateStr) return null;
  const parts = dateStr.split('.');
  if (parts.length !== 3) return null;
  const [day, month, year] = parts;
  return new Date(parseInt(year), parseInt(month) - 1, parseInt(day)).toISOString();
}

// –ü–∞—Ä—Å–∏–Ω–≥ CSV –≤ –æ–±—ä–µ–∫—Ç—ã
function parseCSV(csv) {
  const lines = csv.trim().split('\n');
  const headers = lines[0].split(',');
  const data = [];

  for (let i = 1; i < lines.length; i++) {
    const values = lines[i].split(',');
    const obj = {};
    headers.forEach((h, idx) => {
      obj[h.trim()] = values[idx]?.trim() || '';
    });
    data.push(obj);
  }
  return data;
}

async function supabaseRequest(endpoint, method, body = null) {
  const url = `${SUPABASE_URL}/rest/v1/${endpoint}`;
  const options = {
    method,
    headers: {
      'apikey': SUPABASE_KEY,
      'Authorization': `Bearer ${SUPABASE_KEY}`,
      'Content-Type': 'application/json',
      'Prefer': 'return=representation'
    }
  };
  if (body) {
    options.body = JSON.stringify(body);
  }

  const response = await fetch(url, options);
  const text = await response.text();

  if (!response.ok) {
    throw new Error(`Supabase error: ${response.status} - ${text}`);
  }

  return text ? JSON.parse(text) : null;
}

async function importNewUsers() {
  console.log('üöÄ –ù–∞—á–∏–Ω–∞—é –∏–º–ø–æ—Ä—Ç legacy-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...\n');

  const users = parseCSV(csvData);
  console.log(`üìä –ù–∞–π–¥–µ–Ω–æ ${users.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞\n`);

  const now = new Date();
  let imported = 0;
  let skipped = 0;
  let errors = 0;

  for (const user of users) {
    const telegramId = parseInt(user.tg_id);
    if (isNaN(telegramId)) {
      console.log(`‚ö†Ô∏è –ü—Ä–æ–ø—É—Å–∫: –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π tg_id: ${user.tg_id}`);
      skipped++;
      continue;
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –≤ –±–∞–∑–µ
    try {
      const existing = await supabaseRequest(
        `premium_clients?telegram_id=eq.${telegramId}&select=id`,
        'GET'
      );

      if (existing && existing.length > 0) {
        console.log(`‚è≠Ô∏è –ü—Ä–æ–ø—É—Å–∫ ${telegramId} (${user.username}) - —É–∂–µ –≤ –±–∞–∑–µ`);
        skipped++;
        continue;
      }
    } catch (e) {
      // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
    }

    // –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è
    const expiresAt = parseDate(user.expires_date);
    if (!expiresAt) {
      console.log(`‚ö†Ô∏è –ü—Ä–æ–ø—É—Å–∫ ${telegramId}: –Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è –¥–∞—Ç–∞ ${user.expires_date}`);
      skipped++;
      continue;
    }

    // –£–±–∏—Ä–∞–µ–º @ –∏–∑ username
    const username = user.username === '–Ω–µ—Ç' ? null : user.username?.replace('@', '');

    // –°–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å
    const newClient = {
      telegram_id: telegramId,
      username: username,
      plan: 'trader',           // –¢–∞—Ä–∏—Ñ –¥–ª—è legacy
      source: 'migration',      // –ò—Å—Ç–æ—á–Ω–∏–∫
      tags: ['legacy'],         // –ú–µ—Ç–∫–∞
      started_at: now.toISOString(),
      expires_at: expiresAt,
      in_channel: true,         // –£–∂–µ –≤ –∫–∞–Ω–∞–ª–µ
      in_chat: true,            // –£–∂–µ –≤ —á–∞—Ç–µ
      total_paid_usd: 0,        // –ù–µ –ø–ª–∞—Ç–∏–ª–∏ –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
      payments_count: 0,
      created_at: now.toISOString(),
      updated_at: now.toISOString()
    };

    try {
      await supabaseRequest('premium_clients', 'POST', newClient);
      console.log(`‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω: ${telegramId} (${username || 'no username'}) –¥–æ ${user.expires_date}`);
      imported++;
    } catch (e) {
      console.log(`‚ùå –û—à–∏–±–∫–∞ ${telegramId}: ${e.message}`);
      errors++;
    }

    // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å API
    await new Promise(r => setTimeout(r, 50));
  }

  console.log('\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–º–ø–æ—Ä—Ç–∞ –Ω–æ–≤—ã—Ö:');
  console.log(`   ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: ${imported}`);
  console.log(`   ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: ${skipped}`);
  console.log(`   ‚ùå –û—à–∏–±–æ–∫: ${errors}`);

  return { imported, skipped, errors };
}

async function addDaysToExisting() {
  console.log('\nüîÑ –î–æ–±–∞–≤–ª—è—é –¥–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º...\n');

  let updated = 0;
  let notFound = 0;
  let errors = 0;

  for (const { tg_id, days } of usersToAddDays) {
    try {
      // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
      const existing = await supabaseRequest(
        `premium_clients?telegram_id=eq.${tg_id}&select=id,expires_at,tags`,
        'GET'
      );

      if (!existing || existing.length === 0) {
        console.log(`‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω: ${tg_id}`);
        notFound++;
        continue;
      }

      const client = existing[0];
      const currentExpires = new Date(client.expires_at);
      const newExpires = new Date(currentExpires.getTime() + days * 24 * 60 * 60 * 1000);

      // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–≥ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
      const tags = client.tags || [];
      if (!tags.includes('legacy_bonus')) {
        tags.push('legacy_bonus');
      }

      await supabaseRequest(
        `premium_clients?id=eq.${client.id}`,
        'PATCH',
        {
          expires_at: newExpires.toISOString(),
          tags: tags,
          updated_at: new Date().toISOString()
        }
      );

      console.log(`‚úÖ ${tg_id}: +${days} –¥–Ω–µ–π (–¥–æ ${newExpires.toLocaleDateString()})`);
      updated++;
    } catch (e) {
      console.log(`‚ùå –û—à–∏–±–∫–∞ ${tg_id}: ${e.message}`);
      errors++;
    }
  }

  console.log('\nüìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–Ω–µ–π:');
  console.log(`   ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ: ${updated}`);
  console.log(`   ‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω–æ: ${notFound}`);
  console.log(`   ‚ùå –û—à–∏–±–æ–∫: ${errors}`);

  return { updated, notFound, errors };
}

async function main() {
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  console.log('   –ò–ú–ü–û–†–¢ LEGACY –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô AR CLUB');
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n');

  // –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö
  const importResult = await importNewUsers();

  // –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–Ω–µ–π
  const addDaysResult = await addDaysToExisting();

  // –ò—Ç–æ–≥–æ
  console.log('\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  console.log('   –ò–¢–û–ì–û');
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
  console.log(`   –ù–æ–≤—ã—Ö –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: ${importResult.imported}`);
  console.log(`   –î–Ω–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ: ${addDaysResult.updated} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º`);
  console.log(`   –î–ª—è –∫–∏–∫–∞: ${usersToKick.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π`);
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n');

  console.log('üéØ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–ª—è –∫–∏–∫–∞:');
  usersToKick.forEach(id => console.log(`   - ${id}`));
}

main().catch(console.error);
