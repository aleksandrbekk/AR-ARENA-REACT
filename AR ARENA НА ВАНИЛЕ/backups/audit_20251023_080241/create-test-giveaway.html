<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Test Giveaway</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'SF Pro Display', -apple-system, sans-serif;
            background: #0a0a0a;
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { color: #FFD700; margin-bottom: 20px; font-size: 32px; }
        .card {
            background: rgba(20,20,20,0.8);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,215,0,0.2);
        }
        .btn {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        .btn:hover { transform: translateY(-2px); transition: 0.2s; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        #log {
            background: #000;
            padding: 20px;
            border-radius: 12px;
            font-family: Monaco, monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .log-item { margin-bottom: 8px; padding: 8px; border-radius: 6px; }
        .log-success { color: #38EF7D; background: rgba(56,239,125,0.1); }
        .log-error { color: #FF6B35; background: rgba(255,107,53,0.1); }
        .log-info { color: #4A9EFF; }
        .log-warning { color: #FFA500; }
        .params {
            background: rgba(255,215,0,0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .param-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .param-label { color: #999; }
        .param-value { color: #FFD700; font-weight: bold; }
        .result-card {
            background: rgba(56,239,125,0.1);
            border: 2px solid #38EF7D;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            display: none;
        }
        .result-id {
            font-size: 48px;
            color: #38EF7D;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé∞ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–æ–∑—ã–≥—Ä—ã—à–∞</h1>

        <div class="card">
            <h2 style="color: #FFD700; margin-bottom: 15px;">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–æ–∑—ã–≥—Ä—ã—à–∞</h2>
            <div class="params">
                <div class="param-item">
                    <span class="param-label">–ù–∞–∑–≤–∞–Ω–∏–µ:</span>
                    <span class="param-value">–î–µ–Ω–µ–∂–Ω—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à 50000 AR</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–¢–∏–ø:</span>
                    <span class="param-value">money</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–ü—Ä–∏–∑:</span>
                    <span class="param-value">50000 AR –º–æ–Ω–µ—Ç</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–¶–µ–Ω–∞ –±–∏–ª–µ—Ç–∞:</span>
                    <span class="param-value">100 AR</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–ú–∞–∫—Å. –±–∏–ª–µ—Ç–æ–≤:</span>
                    <span class="param-value">500 –±–∏–ª–µ—Ç–æ–≤</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–ù–∞—á–∞–ª–æ –ø—Ä–æ–¥–∞–∂:</span>
                    <span class="param-value">–°–µ–π—á–∞—Å</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–û–∫–æ–Ω—á–∞–Ω–∏–µ –ø—Ä–æ–¥–∞–∂:</span>
                    <span class="param-value">19 –æ–∫—Ç—è–±—Ä—è 2025, 20:00</span>
                </div>
                <div class="param-item">
                    <span class="param-label">–°—Ç–∞—Ç—É—Å:</span>
                    <span class="param-value">active</span>
                </div>
            </div>
            <button class="btn" id="createBtn">üöÄ –°–æ–∑–¥–∞—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à</button>
        </div>

        <div class="result-card" id="resultCard">
            <h2 style="color: #38EF7D; margin-bottom: 10px; text-align: center;">‚úÖ –†–æ–∑—ã–≥—Ä—ã—à —Å–æ–∑–¥–∞–Ω!</h2>
            <div class="result-id" id="giveawayId">‚Äî</div>
            <div style="text-align: center; color: #999; font-size: 14px;">ID —Ä–æ–∑—ã–≥—Ä—ã—à–∞</div>
        </div>

        <div class="card">
            <h3 style="color: #FFD700; margin-bottom: 15px;">üìù Log</h3>
            <div id="log"></div>
        </div>
    </div>

    <script>
        const supabase = window.supabase.createClient(
            'https://syxjkircmiwpnpagznay.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5eGpraXJjbWl3cG5wYWd6bmF5Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1Nzc2NDQxMSwiZXhwIjoyMDczMzQwNDExfQ.7ueEYBhFrxKU3_RJi_iJEDj6EQqWBy3gAXiM4YIALqs'
        );

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `log-item log-${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            document.getElementById('log').appendChild(div);
            document.getElementById('log').scrollTop = document.getElementById('log').scrollHeight;
        }

        async function createTestGiveaway() {
            const btn = document.getElementById('createBtn');
            btn.disabled = true;

            log('üîó Connecting to Supabase...', 'info');

            try {
                // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
                const giveawayData = {
                    title: '–î–µ–Ω–µ–∂–Ω—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à 50000 AR',
                    description: '–¢–µ—Å—Ç–æ–≤—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à –Ω–∞ 50000 AR –º–æ–Ω–µ—Ç. –ö—É–ø–∏—Ç–µ –±–∏–ª–µ—Ç –∑–∞ 100 AR –∏ —É—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ! –ü–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç 50000 AR –º–æ–Ω–µ—Ç –Ω–∞ —Å–≤–æ–π —Å—á—ë—Ç.',
                    prize_description: '50000 AR –º–æ–Ω–µ—Ç –Ω–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å',
                    prize_ar: 50000,
                    prize_image_url: null,
                    start_date: new Date().toISOString(),
                    end_date: '2025-10-19T20:00:00+00:00',
                    status: 'active',
                    ticket_price_ar: 100,
                    max_tickets: 500,
                    sold_tickets: 0
                };

                log('üìù Creating giveaway with params:', 'info');
                log(JSON.stringify(giveawayData, null, 2), 'info');

                // –°–æ–∑–¥–∞—ë–º —Ä–æ–∑—ã–≥—Ä—ã—à
                const { data, error } = await supabase
                    .from('giveaways')
                    .insert([giveawayData])
                    .select();

                if (error) {
                    log(`‚ùå Error: ${error.message}`, 'error');
                    log(`Details: ${JSON.stringify(error, null, 2)}`, 'error');
                    btn.disabled = false;
                    return;
                }

                log('‚úÖ Giveaway created successfully!', 'success');
                log(`Giveaway data: ${JSON.stringify(data, null, 2)}`, 'success');

                const giveawayId = data[0].id;
                log(`üé∞ Giveaway ID: ${giveawayId}`, 'success');

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                document.getElementById('giveawayId').textContent = giveawayId;
                document.getElementById('resultCard').style.display = 'block';

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à
                log('üîç Verifying created giveaway...', 'info');

                const { data: verifyData, error: verifyError } = await supabase
                    .from('giveaways')
                    .select('*')
                    .eq('id', giveawayId)
                    .single();

                if (verifyError) {
                    log(`‚ö†Ô∏è Verification error: ${verifyError.message}`, 'warning');
                } else {
                    log('‚úÖ Giveaway verified!', 'success');
                    log(`Title: ${verifyData.title}`, 'info');
                    log(`Prize: ${verifyData.prize_ar} AR`, 'info');
                    log(`Ticket price: ${verifyData.ticket_price_ar} AR`, 'info');
                    log(`Max tickets: ${verifyData.max_tickets}`, 'info');
                    log(`Status: ${verifyData.status}`, 'info');
                    log(`End date: ${new Date(verifyData.end_date).toLocaleString('ru-RU')}`, 'info');
                }

                log('üéâ All done!', 'success');

            } catch (err) {
                log(`‚ùå Exception: ${err.message}`, 'error');
                console.error(err);
            }

            btn.disabled = false;
        }

        document.getElementById('createBtn').addEventListener('click', createTestGiveaway);

        // Auto-log on page load
        setTimeout(() => {
            log('üìã Ready to create test giveaway', 'info');
            log('Click the button above to create', 'info');
        }, 500);
    </script>
</body>
</html>
